#!/bin/bash
set -e
cd "$(dirname "$(dirname "$0")")/book"


# Ensure shared dir exists
mkdir -p shared

# Build HTML
if [[ "$1" != "--skip" ]]; then
    ../.bin/build
fi
cp ../dist/book.html shared/book.html

# Build CSS
../node_modules/.bin/sass ../src/book.sass shared/book.css

# Render to PDF
sudo docker build -t sj_book .
sudo docker run --rm --network=host -v "$PWD/shared":/home/app/shared sj_book
